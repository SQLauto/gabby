USE [gabby];
GO

CREATE OR ALTER VIEW tableau.attendance_dashboard_archive AS

SELECT 'kippcamden' AS [db_name]
      ,[academic_year]
      ,[att_code]
      ,[calendardate]
      ,[enroll_status]
      ,[ethnicity]
      ,[gender]
      ,[grade_level]
      ,[iep_status]
      ,[is_absent]
      ,[is_iss_running]
      ,[is_oss_running]
      ,[is_present]
      ,[is_suspended_running]
      ,[is_tardy]
      ,[lastfirst]
      ,[membershipvalue]
      ,[n_A]
      ,[n_A_E]
      ,[n_AD]
      ,[n_AE]
      ,[n_CR]
      ,[n_CS]
      ,[n_D]
      ,[n_E]
      ,[n_EA]
      ,[n_ET]
      ,[n_EV]
      ,[n_ISS]
      ,[n_NM]
      ,[n_OS]
      ,[n_OSS]
      ,[n_OSSP]
      ,[n_PLE]
      ,[n_Q]
      ,[n_S]
      ,[n_SE]
      ,[n_T]
      ,[n_T10]
      ,[n_TE]
      ,[n_TLE]
      ,[n_U]
      ,[n_X]
      ,[school_level]
      ,[schoolid]
      ,[section_number]
      ,[student_number]
      ,[studentid]
      ,[suspension_all]
      ,[teacher_name]
      ,[team]
      ,[term]
FROM kippcamden.tableau.attendance_dashboard_archive
UNION ALL
SELECT 'kippmiami' AS [db_name]
      ,[academic_year]
      ,[att_code]
      ,[calendardate]
      ,[enroll_status]
      ,[ethnicity]
      ,[gender]
      ,[grade_level]
      ,[iep_status]
      ,[is_absent]
      ,[is_iss_running]
      ,[is_oss_running]
      ,[is_present]
      ,[is_suspended_running]
      ,[is_tardy]
      ,[lastfirst]
      ,[membershipvalue]
      ,[n_A]
      ,[n_A_E]
      ,[n_AD]
      ,[n_AE]
      ,[n_CR]
      ,[n_CS]
      ,[n_D]
      ,[n_E]
      ,[n_EA]
      ,[n_ET]
      ,[n_EV]
      ,[n_ISS]
      ,[n_NM]
      ,[n_OS]
      ,[n_OSS]
      ,[n_OSSP]
      ,[n_PLE]
      ,[n_Q]
      ,[n_S]
      ,[n_SE]
      ,[n_T]
      ,[n_T10]
      ,[n_TE]
      ,[n_TLE]
      ,[n_U]
      ,[n_X]
      ,[school_level]
      ,[schoolid]
      ,[section_number]
      ,[student_number]
      ,[studentid]
      ,[suspension_all]
      ,[teacher_name]
      ,[team]
      ,[term]
FROM kippmiami.tableau.attendance_dashboard_archive
UNION ALL
SELECT 'kippnewark' AS [db_name]
      ,[academic_year]
      ,[att_code]
      ,[calendardate]
      ,[enroll_status]
      ,[ethnicity]
      ,[gender]
      ,[grade_level]
      ,[iep_status]
      ,[is_absent]
      ,[is_iss_running]
      ,[is_oss_running]
      ,[is_present]
      ,[is_suspended_running]
      ,[is_tardy]
      ,[lastfirst]
      ,[membershipvalue]
      ,[n_A]
      ,[n_A_E]
      ,[n_AD]
      ,[n_AE]
      ,[n_CR]
      ,[n_CS]
      ,[n_D]
      ,[n_E]
      ,[n_EA]
      ,[n_ET]
      ,[n_EV]
      ,[n_ISS]
      ,[n_NM]
      ,[n_OS]
      ,[n_OSS]
      ,[n_OSSP]
      ,[n_PLE]
      ,[n_Q]
      ,[n_S]
      ,[n_SE]
      ,[n_T]
      ,[n_T10]
      ,[n_TE]
      ,[n_TLE]
      ,[n_U]
      ,[n_X]
      ,[school_level]
      ,[schoolid]
      ,[section_number]
      ,[student_number]
      ,[studentid]
      ,[suspension_all]
      ,[teacher_name]
      ,[team]
      ,[term]
FROM kippnewark.tableau.attendance_dashboard_archive;