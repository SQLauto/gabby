USE [gabby];
GO

CREATE OR ALTER VIEW powerschool.final_grades_wide AS

SELECT 'kippcamden' AS [db_name]
      ,[academic_year]
      ,[course_name]
      ,[course_number]
      ,[credit_hours]
      ,[credittype]
      ,[cur_term_grade_letter]
      ,[cur_term_grade_letter_adjusted]
      ,[cur_term_grade_percent]
      ,[cur_term_grade_percent_adjusted]
      ,[e1_grade_percent]
      ,[e2_grade_percent]
      ,[excludefromgpa]
      ,[is_curterm]
      ,[need_65]
      ,[need_70]
      ,[need_80]
      ,[need_90]
      ,[reporting_term]
      ,[rn_credittype]
      ,[rt1_term_grade_letter]
      ,[rt1_term_grade_letter_adjusted]
      ,[rt1_term_grade_percent]
      ,[rt1_term_grade_percent_adjusted]
      ,[rt2_term_grade_letter]
      ,[rt2_term_grade_letter_adjusted]
      ,[rt2_term_grade_percent]
      ,[rt2_term_grade_percent_adjusted]
      ,[rt3_term_grade_letter]
      ,[rt3_term_grade_letter_adjusted]
      ,[rt3_term_grade_percent]
      ,[rt3_term_grade_percent_adjusted]
      ,[rt4_term_grade_letter]
      ,[rt4_term_grade_letter_adjusted]
      ,[rt4_term_grade_percent]
      ,[rt4_term_grade_percent_adjusted]
      ,[sectionid]
      ,[student_number]
      ,[studentid]
      ,[teacher_name]
      ,[term_name]
      ,[y1_grade_letter]
      ,[y1_grade_percent]
FROM kippcamden.powerschool.final_grades_wide
UNION ALL
SELECT 'kippmiami' AS [db_name]
      ,[academic_year]
      ,[course_name]
      ,[course_number]
      ,[credit_hours]
      ,[credittype]
      ,[cur_term_grade_letter]
      ,[cur_term_grade_letter_adjusted]
      ,[cur_term_grade_percent]
      ,[cur_term_grade_percent_adjusted]
      ,[e1_grade_percent]
      ,[e2_grade_percent]
      ,[excludefromgpa]
      ,[is_curterm]
      ,[need_65]
      ,[need_70]
      ,[need_80]
      ,[need_90]
      ,[reporting_term]
      ,[rn_credittype]
      ,[rt1_term_grade_letter]
      ,[rt1_term_grade_letter_adjusted]
      ,[rt1_term_grade_percent]
      ,[rt1_term_grade_percent_adjusted]
      ,[rt2_term_grade_letter]
      ,[rt2_term_grade_letter_adjusted]
      ,[rt2_term_grade_percent]
      ,[rt2_term_grade_percent_adjusted]
      ,[rt3_term_grade_letter]
      ,[rt3_term_grade_letter_adjusted]
      ,[rt3_term_grade_percent]
      ,[rt3_term_grade_percent_adjusted]
      ,[rt4_term_grade_letter]
      ,[rt4_term_grade_letter_adjusted]
      ,[rt4_term_grade_percent]
      ,[rt4_term_grade_percent_adjusted]
      ,[sectionid]
      ,[student_number]
      ,[studentid]
      ,[teacher_name]
      ,[term_name]
      ,[y1_grade_letter]
      ,[y1_grade_percent]
FROM kippmiami.powerschool.final_grades_wide
UNION ALL
SELECT 'kippnewark' AS [db_name]
      ,[academic_year]
      ,[course_name]
      ,[course_number]
      ,[credit_hours]
      ,[credittype]
      ,[cur_term_grade_letter]
      ,[cur_term_grade_letter_adjusted]
      ,[cur_term_grade_percent]
      ,[cur_term_grade_percent_adjusted]
      ,[e1_grade_percent]
      ,[e2_grade_percent]
      ,[excludefromgpa]
      ,[is_curterm]
      ,[need_65]
      ,[need_70]
      ,[need_80]
      ,[need_90]
      ,[reporting_term]
      ,[rn_credittype]
      ,[rt1_term_grade_letter]
      ,[rt1_term_grade_letter_adjusted]
      ,[rt1_term_grade_percent]
      ,[rt1_term_grade_percent_adjusted]
      ,[rt2_term_grade_letter]
      ,[rt2_term_grade_letter_adjusted]
      ,[rt2_term_grade_percent]
      ,[rt2_term_grade_percent_adjusted]
      ,[rt3_term_grade_letter]
      ,[rt3_term_grade_letter_adjusted]
      ,[rt3_term_grade_percent]
      ,[rt3_term_grade_percent_adjusted]
      ,[rt4_term_grade_letter]
      ,[rt4_term_grade_letter_adjusted]
      ,[rt4_term_grade_percent]
      ,[rt4_term_grade_percent_adjusted]
      ,[sectionid]
      ,[student_number]
      ,[studentid]
      ,[teacher_name]
      ,[term_name]
      ,[y1_grade_letter]
      ,[y1_grade_percent]
FROM kippnewark.powerschool.final_grades_wide;