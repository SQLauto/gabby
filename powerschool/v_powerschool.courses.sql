USE [gabby];
GO

CREATE OR ALTER VIEW powerschool.courses AS

SELECT 'kippcamden' AS [db_name]
      ,[add_to_gpa]
      ,[course_name]
      ,[course_number]
      ,[course_number_clean]
      ,[credit_hours]
      ,[credittype]
      ,[crhrweight]
      ,[dcid]
      ,[exclude_ada]
      ,[excludefromclassrank]
      ,[excludefromgpa]
      ,[excludefromhonorroll]
      ,[excludefromstoredgrades]
      ,[gpa_addedvalue]
      ,[gradescaleid]
      ,[id]
      ,[maxclasssize]
      ,[maxcredit]
      ,[prerequisitesvalue]
      ,[programid]
      ,[regavailable]
      ,[sched_balanceterms]
      ,[sched_blockstart]
      ,[sched_closesectionaftermax]
      ,[sched_concurrentflag]
      ,[sched_consecutiveperiods]
      ,[sched_consecutiveterms]
      ,[sched_coursepackage]
      ,[sched_coursesubjectareacode]
      ,[sched_department]
      ,[sched_do_not_print]
      ,[sched_frequency]
      ,[sched_fullcatalogdescription]
      ,[sched_labflag]
      ,[sched_labfrequency]
      ,[sched_labperiodspermeeting]
      ,[sched_lengthinnumberofterms]
      ,[sched_loadpriority]
      ,[sched_loadtype]
      ,[sched_lunchcourse]
      ,[sched_maximumdayspercycle]
      ,[sched_maximumenrollment]
      ,[sched_maximumperiodsperday]
      ,[sched_minimumdayspercycle]
      ,[sched_minimumperiodsperday]
      ,[sched_multiplerooms]
      ,[sched_periodspercycle]
      ,[sched_periodspermeeting]
      ,[sched_repeatsallowed]
      ,[sched_scheduled]
      ,[sched_scheduletypecode]
      ,[sched_sectionsoffered]
      ,[sched_substitutionallowed]
      ,[sched_teachercount]
      ,[sched_usepreestablishedteams]
      ,[sched_usesectiontypes]
      ,[sched_validstartperiods]
      ,[sched_year]
      ,[schoolgroup]
      ,[schoolid]
      ,[sectionstooffer]
      ,[status]
      ,[targetclasssize]
      ,[termsoffered]
      ,[vocational]
FROM kippcamden.powerschool.courses
UNION ALL
SELECT 'kippmiami' AS [db_name]
      ,[add_to_gpa]
      ,[course_name]
      ,[course_number]
      ,[course_number_clean]
      ,[credit_hours]
      ,[credittype]
      ,[crhrweight]
      ,[dcid]
      ,[exclude_ada]
      ,[excludefromclassrank]
      ,[excludefromgpa]
      ,[excludefromhonorroll]
      ,[excludefromstoredgrades]
      ,[gpa_addedvalue]
      ,[gradescaleid]
      ,[id]
      ,[maxclasssize]
      ,[maxcredit]
      ,[prerequisitesvalue]
      ,[programid]
      ,[regavailable]
      ,[sched_balanceterms]
      ,[sched_blockstart]
      ,[sched_closesectionaftermax]
      ,[sched_concurrentflag]
      ,[sched_consecutiveperiods]
      ,[sched_consecutiveterms]
      ,[sched_coursepackage]
      ,[sched_coursesubjectareacode]
      ,[sched_department]
      ,[sched_do_not_print]
      ,[sched_frequency]
      ,[sched_fullcatalogdescription]
      ,[sched_labflag]
      ,[sched_labfrequency]
      ,[sched_labperiodspermeeting]
      ,[sched_lengthinnumberofterms]
      ,[sched_loadpriority]
      ,[sched_loadtype]
      ,[sched_lunchcourse]
      ,[sched_maximumdayspercycle]
      ,[sched_maximumenrollment]
      ,[sched_maximumperiodsperday]
      ,[sched_minimumdayspercycle]
      ,[sched_minimumperiodsperday]
      ,[sched_multiplerooms]
      ,[sched_periodspercycle]
      ,[sched_periodspermeeting]
      ,[sched_repeatsallowed]
      ,[sched_scheduled]
      ,[sched_scheduletypecode]
      ,[sched_sectionsoffered]
      ,[sched_substitutionallowed]
      ,[sched_teachercount]
      ,[sched_usepreestablishedteams]
      ,[sched_usesectiontypes]
      ,[sched_validstartperiods]
      ,[sched_year]
      ,[schoolgroup]
      ,[schoolid]
      ,[sectionstooffer]
      ,[status]
      ,[targetclasssize]
      ,[termsoffered]
      ,[vocational]
FROM kippmiami.powerschool.courses
UNION ALL
SELECT 'kippnewark' AS [db_name]
      ,[add_to_gpa]
      ,[course_name]
      ,[course_number]
      ,[course_number_clean]
      ,[credit_hours]
      ,[credittype]
      ,[crhrweight]
      ,[dcid]
      ,[exclude_ada]
      ,[excludefromclassrank]
      ,[excludefromgpa]
      ,[excludefromhonorroll]
      ,[excludefromstoredgrades]
      ,[gpa_addedvalue]
      ,[gradescaleid]
      ,[id]
      ,[maxclasssize]
      ,[maxcredit]
      ,[prerequisitesvalue]
      ,[programid]
      ,[regavailable]
      ,[sched_balanceterms]
      ,[sched_blockstart]
      ,[sched_closesectionaftermax]
      ,[sched_concurrentflag]
      ,[sched_consecutiveperiods]
      ,[sched_consecutiveterms]
      ,[sched_coursepackage]
      ,[sched_coursesubjectareacode]
      ,[sched_department]
      ,[sched_do_not_print]
      ,[sched_frequency]
      ,[sched_fullcatalogdescription]
      ,[sched_labflag]
      ,[sched_labfrequency]
      ,[sched_labperiodspermeeting]
      ,[sched_lengthinnumberofterms]
      ,[sched_loadpriority]
      ,[sched_loadtype]
      ,[sched_lunchcourse]
      ,[sched_maximumdayspercycle]
      ,[sched_maximumenrollment]
      ,[sched_maximumperiodsperday]
      ,[sched_minimumdayspercycle]
      ,[sched_minimumperiodsperday]
      ,[sched_multiplerooms]
      ,[sched_periodspercycle]
      ,[sched_periodspermeeting]
      ,[sched_repeatsallowed]
      ,[sched_scheduled]
      ,[sched_scheduletypecode]
      ,[sched_sectionsoffered]
      ,[sched_substitutionallowed]
      ,[sched_teachercount]
      ,[sched_usepreestablishedteams]
      ,[sched_usesectiontypes]
      ,[sched_validstartperiods]
      ,[sched_year]
      ,[schoolgroup]
      ,[schoolid]
      ,[sectionstooffer]
      ,[status]
      ,[targetclasssize]
      ,[termsoffered]
      ,[vocational]
FROM kippnewark.powerschool.courses;