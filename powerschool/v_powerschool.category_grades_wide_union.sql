USE [gabby];
GO

CREATE OR ALTER VIEW powerschool.category_grades_wide AS

SELECT 'kippnewark' AS [db_name]
      ,[A_CUR]
      ,[A_RT1]
      ,[A_RT2]
      ,[A_RT3]
      ,[A_RT4]
      ,[A_Y1]
      ,[academic_year]
      ,[C_CUR]
      ,[C_RT1]
      ,[C_RT2]
      ,[C_RT3]
      ,[C_RT4]
      ,[C_Y1]
      ,[course_number]
      ,[credittype]
      ,[E_CUR]
      ,[E_RT1]
      ,[E_RT2]
      ,[E_RT3]
      ,[E_RT4]
      ,[E_Y1]
      ,[H_CUR]
      ,[H_RT1]
      ,[H_RT2]
      ,[H_RT3]
      ,[H_RT4]
      ,[H_Y1]
      ,[is_curterm]
      ,[P_CUR]
      ,[P_RT1]
      ,[P_RT2]
      ,[P_RT3]
      ,[P_RT4]
      ,[P_Y1]
      ,[reporting_term]
      ,[rn_credittype]
      ,[S_CUR]
      ,[S_RT1]
      ,[S_RT2]
      ,[S_RT3]
      ,[S_RT4]
      ,[S_Y1]
      ,[schoolid]
      ,[sectionid]
      ,[student_number]
      ,[teacher_name]
FROM kippnewark.powerschool.category_grades_wide
UNION ALL
SELECT 'kippmiami' AS [db_name]
      ,[A_CUR]
      ,[A_RT1]
      ,[A_RT2]
      ,[A_RT3]
      ,[A_RT4]
      ,[A_Y1]
      ,[academic_year]
      ,[C_CUR]
      ,[C_RT1]
      ,[C_RT2]
      ,[C_RT3]
      ,[C_RT4]
      ,[C_Y1]
      ,[course_number]
      ,[credittype]
      ,[E_CUR]
      ,[E_RT1]
      ,[E_RT2]
      ,[E_RT3]
      ,[E_RT4]
      ,[E_Y1]
      ,[H_CUR]
      ,[H_RT1]
      ,[H_RT2]
      ,[H_RT3]
      ,[H_RT4]
      ,[H_Y1]
      ,[is_curterm]
      ,[P_CUR]
      ,[P_RT1]
      ,[P_RT2]
      ,[P_RT3]
      ,[P_RT4]
      ,[P_Y1]
      ,[reporting_term]
      ,[rn_credittype]
      ,[S_CUR]
      ,[S_RT1]
      ,[S_RT2]
      ,[S_RT3]
      ,[S_RT4]
      ,[S_Y1]
      ,[schoolid]
      ,[sectionid]
      ,[student_number]
      ,[teacher_name]
FROM kippmiami.powerschool.category_grades_wide
UNION ALL
SELECT 'kippcamden' AS [db_name]
      ,[A_CUR]
      ,[A_RT1]
      ,[A_RT2]
      ,[A_RT3]
      ,[A_RT4]
      ,[A_Y1]
      ,[academic_year]
      ,[C_CUR]
      ,[C_RT1]
      ,[C_RT2]
      ,[C_RT3]
      ,[C_RT4]
      ,[C_Y1]
      ,[course_number]
      ,[credittype]
      ,[E_CUR]
      ,[E_RT1]
      ,[E_RT2]
      ,[E_RT3]
      ,[E_RT4]
      ,[E_Y1]
      ,[H_CUR]
      ,[H_RT1]
      ,[H_RT2]
      ,[H_RT3]
      ,[H_RT4]
      ,[H_Y1]
      ,[is_curterm]
      ,[P_CUR]
      ,[P_RT1]
      ,[P_RT2]
      ,[P_RT3]
      ,[P_RT4]
      ,[P_Y1]
      ,[reporting_term]
      ,[rn_credittype]
      ,[S_CUR]
      ,[S_RT1]
      ,[S_RT2]
      ,[S_RT3]
      ,[S_RT4]
      ,[S_Y1]
      ,[schoolid]
      ,[sectionid]
      ,[student_number]
      ,[teacher_name]
FROM kippcamden.powerschool.category_grades_wide;